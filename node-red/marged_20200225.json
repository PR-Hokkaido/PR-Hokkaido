[{"id":"53380e8a.50b99","type":"template","z":"5823240e.70bc1c","name":"地図画面の表示","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<!DOCTYPE html>\n<html>\n\n<head>\n  <meta charset=\"utf-8\" />\n  <title>異常箇所Map</title>\n  <meta name=\"viewport\" content=\"initial-scale=1,maximum-scale=1,user-scalable=no\" />\n  <script src=\"https://api.mapbox.com/mapbox-gl-js/v1.6.1/mapbox-gl.js\"></script>\n  <link href=\"https://api.mapbox.com/mapbox-gl-js/v1.6.1/mapbox-gl.css\" rel=\"stylesheet\" />\n  <style>\n    body {\n      margin: 0;\n      padding: 0;\n    }\n\n    #map {\n      position: absolute;\n      top: 175px;\n      bottom: 25px;\n      width: 100%;\n    }\n\n    .box3 {\n      padding: 0.5em 1em;\n      margin: 2em 0;\n      color: #2c2c2f;\n      background: #cde4ff;\n      /*背景色*/\n    }\n\n    .box3 p {\n      margin: 0;\n      padding: 0;\n    }\n\n    example {\n      margin: 10px auto;\n      width: 50px;\n      background: orange;\n    }\n  </style>\n</head>\n\n<body>\n  <center>\n    <div class=\"box3\">\n      <h2>異常箇所結果Map</h2>\n    </div>\n\n    <div id=\"map\"></div>\n    <script>\n      //---------------\n      //Mapについての設定\n      //---------------\n      //  地図を作成\n      mapboxgl.accessToken = 'pk.eyJ1IjoiYXNha2F3YTciLCJhIjoiY2s2aHRmNWZwMmhncDNrbWd4ampxamh4cSJ9.MSCzgEW8zCHs38HUbzJ6dQ';\n      var map = new mapboxgl.Map({\n        container: 'map', // container id\n        style: 'mapbox://styles/mapbox/streets-v11',\n        center: [141.350755, 43.068661], // 初期表示（経度, 緯度）\n        zoom: 10 // starting zoom\n      });\n\n      //---------------\n      //ポインタの設定(ダミーデータ)\n      //---------------\n      var data = {\n        'type': 'geojson',\n        'data': {\n          'type': 'FeatureCollection',\n          // GPSの値を設定\n          'features': [\n            //1つ目\n            {\n              'type': 'Feature',\n              'geometry': {\n                'type': 'Point',\n                'coordinates': [141.400349, 43.062974]\n              }\n            },\n\n            //2つ目\n            {\n              'type': 'Feature',\n              'geometry': {\n                'type': 'Point',\n                'coordinates': [141.318520, 43.091557]\n              }\n            },\n\n            //3つ目\n            {\n              'type': 'Feature',\n              'geometry': {\n                'type': 'Point',\n                'coordinates': [141.313456, 43.091000]\n              }\n            }\n          ]\n        }\n      };\n\n      // 追加したい緯度経度の情報\n      //TODO cloudantで取得した経度緯度情報を設定\n      var positions = [\n        { latitude: 43.041999, longitude: 141.302488 },\n        { latitude: 43.051588, longitude: 141.392455 }\n      ];\n\n\n      var features = data.data.features;\n      for (var i = 0; i < Object.keys(positions).length; i++) {\n\n        var coord = {\n          'type': 'Feature',\n          'geometry': {\n            'type': 'Point',\n            'coordinates': [positions[i].longitude, positions[i].latitude]\n          }\n        };\n        features = features.concat(coord);\n      }\n\n      data.data.features = features;\n      console.log(data);\n\n      //地図ナビゲーションコントローラの追加\n      map.addControl(new mapboxgl.NavigationControl());\n\n      map.on('load', function () {\n        map.addSource('national-park', data);\n\n        map.addLayer({\n          'id': 'park-boundary',\n          'type': 'fill',\n          'source': 'national-park',\n          'paint': {\n            'fill-color': '#228822',\n            'fill-opacity': 0.4\n          },\n          'filter': ['==', '$type', 'Polygon']\n        });\n\n        map.addLayer({\n          'id': 'park-volcanoes',\n          'type': 'circle',\n          'source': 'national-park',\n          'paint': {\n            'circle-radius': 6,\n            'circle-color': '#B42222'\n          },\n          'filter': ['==', '$type', 'Point']\n        });\n      });\n    </script>\n    　　\n  </center>\n\n</body>\n\n</html>","output":"str","x":560,"y":1400,"wires":[["4079ffd3.a71b4"]]}]